From: Matt Caswell <matt@openssl.org>
Date: Wed, 18 Aug 2021 14:02:40 +0100
Subject: Fix printing of PROXY_CERT_INFO_EXTENSION to not assume NUL
 terminated strings

ASN.1 strings may not be NUL terminated. Don't assume they are.
---
 crypto/x509v3/v3_pci.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

Index: openssl-1.1.0l/crypto/x509v3/v3_pci.c
===================================================================
--- openssl-1.1.0l.orig/crypto/x509v3/v3_pci.c	2021-09-26 00:10:58.416333326 +0200
+++ openssl-1.1.0l/crypto/x509v3/v3_pci.c	2021-09-26 00:10:58.412333327 +0200
@@ -73,7 +73,8 @@
     i2a_ASN1_OBJECT(out, pci->proxyPolicy->policyLanguage);
     BIO_puts(out, "\n");
     if (pci->proxyPolicy->policy && pci->proxyPolicy->policy->data)
-        BIO_printf(out, "%*sPolicy Text: %s\n", indent, "",
+        BIO_printf(out, "%*sPolicy Text: %.*s\n", indent, "",
+                   pci->proxyPolicy->policy->length,
                    pci->proxyPolicy->policy->data);
     return 1;
 }
