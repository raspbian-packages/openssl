From: Matt Caswell <matt@openssl.org>
Date: Thu, 19 Aug 2021 12:24:17 +0100
Subject: Fix EC_GROUP_new_from_ecparameters to check the base length

Check that there's at least one byte in params->base before trying to
read it.
---
 crypto/ec/ec_asn1.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

Index: openssl-1.1.0l/crypto/ec/ec_asn1.c
===================================================================
--- openssl-1.1.0l.orig/crypto/ec/ec_asn1.c	2021-09-26 00:23:43.308057999 +0200
+++ openssl-1.1.0l/crypto/ec/ec_asn1.c	2021-09-26 00:23:43.304058001 +0200
@@ -770,7 +770,10 @@
         ret->seed_len = params->curve->seed->length;
     }
 
-    if (!params->order || !params->base || !params->base->data) {
+    if (params->order == NULL
+            || params->base == NULL
+            || params->base->data == NULL
+            || params->base->length == 0) {
         ECerr(EC_F_EC_GROUP_NEW_FROM_ECPARAMETERS, EC_R_ASN1_ERROR);
         goto err;
     }
